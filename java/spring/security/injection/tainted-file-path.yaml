rules:
  - id: tainted-file-path
    languages:
      - java
    severity: ERROR
    message:  TODO
    metadata:
      cwe: TODO
      owasp:
        - A03:2021
        - A01:2017
      references:
      - TODO
      category: security
      technology:
        - java
        - spring
    mode: taint
    pattern-sources:
      - patterns:
          - pattern-either:
              - pattern: |
                  @RequestMapping(...) $RETURNTYPE $METHODNAME(..., @$ANNOTATION
                  $TYPE $PARAMETER, ...) {
                    ...
                  }
              - pattern: |
                  @RequestMapping(...) $RETURNTYPE $METHODNAME(...,
                  @$ANNOTATION(...) $TYPE $PARAMETER, ...) {
                    ...
                  }
              - pattern: |
                  $RETURNTYPE $METHODNAME(..., @RequestParam $TYPE $PARAMETER) {
                    ...
                  }
              - pattern: |
                  $RETURNTYPE $METHODNAME(..., @RequestParam($LOOKUP) $TYPE $PARAMETER) {
                    ...
                  }
    pattern-sinks:
    - pattern-either:
      - pattern: new FileInputStream(...)
      - pattern: new FileReader(...)
      - pattern: new File(...)
      - pattern: $SOMETHING.getResourceAsStream(...)